webpackJsonp([19],{dQbL:function(e,t){},"nR+X":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("mvHQ"),i=a.n(s),n=a("bOdI"),r=a.n(n),l=a("mw3O"),o=a.n(l),c=a("UMo0"),d=a("OMN4"),u=a.n(d),p={provide:function(){return{reload:this.reload}},inject:["reload"],name:"equipmentList",data:function(){var e;return e={isRouterAlive:!0,formInline:{id:null,scene:"",project_name:"",submit_date:[new Date,new Date]},listLoading:!1,idtable:[],opencard:[],tableData5:[],multipleSelection:[],value1:"",levelList:[{value:"0",label:"管理卡"},{value:"1",label:"用户卡"}],lastmes:"",level:"0",deviceType:"0",add1:{deviceType:"",cardId:"",endTime:"",startTime:""},type1:{deviceType:""},li:[],added:"",send:{deviceId:"",title:"",timeOut:"",qos:""},cardList:[],change:{card:"",title:"",desc:"",tags:"",lon:"",lat:"",authInfo:"",deviceId:""},status:"",universal:{add:!1,change:!1,look:!1,send:!1,allot:!1},ICData:[],tableData:[],reception:[],con:{id:"",protocol:"",create_time:"",auth_info:"",title:"",desc:"",tags:"",lon:"",lat:"",dataid:"",unit:"",unit_symbol:""}},r()(e,"li",[]),r()(e,"add",!1),r()(e,"topic",!1),r()(e,"conGroup",!1),r()(e,"change",!1),r()(e,"send",!1),r()(e,"see",!1),r()(e,"changeGroups",!1),r()(e,"changeGrouping",{changeGrouping:"",conId:""}),r()(e,"step",0),r()(e,"seeStep",1),r()(e,"paging",{page:1,pageSize:10,total:0}),r()(e,"allot1",{deviceId:"",trafficCard:"",deviceType:"",deviceModel:"",deviceName:"",startTime:"",endTime:"",personnel:"",status:"",iccId:""}),r()(e,"search",{device_type:"",area:"",customername:""}),r()(e,"addTo",{group:{userId:sessionStorage.getItem("userId"),gropuName:"",groupPhone:"",name:"",groupNotes:""}}),r()(e,"controNameL",[{label:"C1",value:1},{label:"C2",value:2},{label:"C3",value:3},{label:"B1",value:4},{label:"B2",value:5},{label:"A1",value:6},{label:"A2",value:7},{label:"A3",value:8}]),e},created:function(){this.add1.deviceType=this.levelList[0].label},mounted:function(){this.searchClick(),document.title=this.$route.meta.title,"123"==sessionStorage.getItem("dealer")&&(this.added=1)},methods:{handleSelectionChange:function(e){this.multipleSelection=e},ICclick:function(){for(var e=this.multipleSelection,t=[],a=0;a<e.length;a++)t.push(e[a].deviceId),this.opencard=t,this.cardList=t;this.universal.look=!1},IChideclick:function(){this.universal.look=!1},deleteid:function(e){var t=this,a=this;this.$confirm("此操作将永久删除该条数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){u()({method:"post",url:t.$store.state.http+"/Iccid/delete",data:o.a.stringify({id:e.id})}).then(function(t){0==t.data.resCode?(a.changeshow(e),a.$message({message:"删除成功",type:"success"})):a.$alert(t.data.result,"系统确认框",{confirmButtonText:"确定"})})}).catch(function(){a.$message({type:"info",message:"已取消删除"})})},open:function(){this.universal.look=!0;var e={pageNum:this.paging.page,pageSize:this.paging.pageSize};e.devId=this.search.deviceId,e.deviceModel=this.type1.deviceType,e.userId=sessionStorage.getItem("userId"),e.dealer=sessionStorage.getItem("dealer"),0==e.dealer&&(e.dealer=sessionStorage.getItem("orderDealers"));var t=this;t.ICData=[],t.timeCrea=[],t.truey=[],u()({method:"post",url:this.$store.state.http+"/devices/conditionFind",data:o.a.stringify(e)}).then(function(e){if(0==e.data.resCode){for(var a=0;a<e.data.result.length;a++)null!=e.data.result[a].startTime.time?e.data.result[a].startTime=(s=i()(e.data.result[a].startTime.time).slice(0,10),n=void 0,void 0,void 0,void 0,void 0,void 0,void 0,n=new Date(1e3*s),r=n.getFullYear(),l=n.getMonth()+1,o=n.getDate(),c=n.getHours(),d=n.getMinutes(),u=n.getSeconds(),r+"-"+l+"-"+o+" "+c+":"+d+":"+u):e.data.result[a].startTime=i()(e.data.result[a].startTime).slice(1,20);t.ICData=e.data.result,t.paging.total=e.data.result2;for(a=0;a<t.ICData.length;a++)t.truey.push(t.ICData[a].status),"0x11"==t.ICData[a].devStatus?t.ICData[a].devStatus="正常":t.ICData[a].devStatus="异常"}else t.ICData=[],t.paging.total=0;var s,n,r,l,o,c,d,u})},hideclick:function(){this.universal.change=!1},indexMethod:function(e){return e+(this.paging.page-1)*this.paging.pageSize+1},handleSizeChange:function(e){this.paging.pageSize=e,this.searchClick()},handleCurrentChange:function(e){this.searchClick()},deleteClick:function(e){var t=this,a=this;this.$confirm("此操作将永久删除该条数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var s=parseInt(e.area).toString(16),i={cmd:23,cmdValue:"21"+("0000000000000000"+s).substr(-8),devId:e.device_type};t.listLoading=!0,u()({method:"post",url:a.$store.state.http+"/send/sendCmd",data:o.a.stringify(i)}).then(function(t){if(0==t.data.resCode)setTimeout(function(){var t={devId:e.device_type};Object(c.a)("/Datapoints/getData",t).then(function(t){if(0==t.data.resCode){for(var s=JSON.parse(t.data.errMsg.slice(6)),i=0;i<s.data.datastreams.length;i++)"2014"==s.data.datastreams[i].id&&(a.lastmes=s.data.datastreams[i].datapoints[0].value);a.lastmes.substr(2,a.lastmes.length)==e.area?u()({method:"post",dataType:"jsonp",url:a.$store.state.http+"/IccIds/queryDelete",data:o.a.stringify({icc_id:e.iccId})}).then(function(e){0==e.data.resCode?(a.listLoading=!1,a.$message({message:"删除成功",type:"success"})):(a.listLoading=!1,a.$message({message:"删除失败",type:"error"}))}):(a.listLoading=!1,a.$message({message:"删除失败",type:"error"})),a.searchClick()}else a.listLoading=!1,a.$message({message:"删除失败",type:"error"})})},5e3);else a.listLoading=!1,a.$message({message:"删除失败",type:"error"})})}).catch(function(){a.$message({type:"info",message:"已取消删除"})})},order:function(e){this.universal.send=!0,this.send=e},allot:function(e){this.universal.allot=!0,this.allot1=e;e.weChatUsePhone},changeGroupShow:function(e){},searchClick:function(){var e={type:5,userId:sessionStorage.getItem("userId"),dealer:sessionStorage.getItem("dealer")};0==e.dealer&&(e.dealer=sessionStorage.getItem("orderDealers")),u()({method:"post",url:this.$store.state.http+"/user/listCustom",data:o.a.stringify(e)}).then(function(e){a.reception=e.data.result});var t={page:this.paging.page,pageSize:this.paging.pageSize,dealer:sessionStorage.getItem("dealer"),state:0};0==t.dealer&&(t.dealer=sessionStorage.getItem("orderDealers")),this.search.device_type&&(t.device_type=this.search.device_type),this.search.customername&&(t.customername=this.search.customername),this.search.area&&(t.area=this.search.area),t.userId=sessionStorage.getItem("userId");var a=this;a.tableData=[],u()({method:"post",url:this.$store.state.http+"/IccIds/queryByIccId",data:o.a.stringify(t)}).then(function(e){a.tableData=e.data.result,a.paging.total=e.data.count})},reload:function(){this.isRouterAlive=!1,this.$nextTick(function(){this.isRouterAlive=!0})},changeGroup:function(){var e=this.add1,t=this;u()({method:"post",url:this.$store.state.http+"/devices/ModifyDevices",data:o.a.stringify(e)}).then(function(e){0==e.data.resCode?(t.searchClick(),t.$message({message:"修改成功",type:"success"})):t.$alert(e.data.result,"系统确认框",{confirmButtonText:"确定"}),t.changeGroups=!1})}}},v={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"PSTlist"}},[e._m(0),e._v(" "),a("div",{staticClass:"select"},[a("span",[e._v("设备编号：")]),e._v(" "),a("el-input",{attrs:{clearable:"",placeholder:"请输入内容"},model:{value:e.search.device_type,callback:function(t){e.$set(e.search,"device_type",t)},expression:"search.device_type"}}),e._v(" "),a("span",[e._v("设备卡号：")]),e._v(" "),a("el-input",{attrs:{clearable:"",placeholder:"请输入内容"},model:{value:e.search.area,callback:function(t){e.$set(e.search,"area",t)},expression:"search.area"}}),e._v(" "),a("span",[e._v("客户名称：")]),e._v(" "),a("el-select",{attrs:{placeholder:"请选择"},on:{change:function(t){e.aaa(e.search.deviceType)}},model:{value:e.search.customername,callback:function(t){e.$set(e.search,"customername",t)},expression:"search.customername"}},[a("el-option",{attrs:{value:""}},[e._v("未选择")]),e._v(" "),e._l(e.reception,function(e){return a("el-option",{key:e.dealerId,attrs:{value:e.customerName}})})],2)],1),e._v(" "),a("div",{staticClass:"select"},[a("el-button",{staticClass:"oyButton",attrs:{type:"success",icon:"el-icon-search"},on:{click:e.searchClick}},[e._v("查询")])],1),e._v(" "),a("el-dialog",{attrs:{title:"新增",visible:e.universal.add},on:{"update:visible":function(t){e.$set(e.universal,"add",t)}}},[a("div",[a("span",{staticClass:"spanClassT"},[a("span",{staticClass:"aKey"},[e._v("*")]),e._v("设备卡号：")]),e._v(" "),a("el-input",{attrs:{clearable:"",placeholder:"请输入内容"},model:{value:e.add1.cardId,callback:function(t){e.$set(e.add1,"cardId",t)},expression:"add1.cardId"}}),a("br"),a("br"),e._v(" "),a("span",{staticClass:"spanClassT"},[e._v("设备编号：")]),e._v(" "),a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.add1.deviceType,callback:function(t){e.$set(e.add1,"deviceType",t)},expression:"add1.deviceType"}},e._l(e.levelList,function(e){return a("el-option",{key:e.value,attrs:{value:e.label}})})),a("br"),a("br"),e._v(" "),a("span",{staticClass:"spanClassT"},[a("span",{staticClass:"aKey"},[e._v("*")]),e._v("开始时间：")]),e._v(" "),a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},model:{value:e.add1.startTime,callback:function(t){e.$set(e.add1,"startTime",t)},expression:"add1.startTime"}}),a("br"),a("br"),e._v(" "),a("span",{staticClass:"spanClassT"},[a("span",{staticClass:"aKey"},[e._v("*")]),e._v("结束时间：")]),e._v(" "),a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},model:{value:e.add1.endTime,callback:function(t){e.$set(e.add1,"endTime",t)},expression:"add1.endTime"}}),a("br"),a("br")],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"oyButton",attrs:{type:"success"},on:{click:function(t){e.universal.add=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{staticClass:"oyButton",attrs:{type:"success"},on:{click:e.addClick}},[e._v("添加")])],1)]),e._v(" "),a("div",{staticClass:"Content"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticClass:"oyTable",staticStyle:{width:"100%"},attrs:{data:e.tableData}},[a("el-table-column",{attrs:{type:"index",index:e.indexMethod,label:"序号",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{label:"设备卡号"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("p",{staticClass:"TsMaxWidth"},[e._v(e._s(t.row.area))]),e._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("div",{staticClass:"overflowHide"},[e._v(e._s(t.row.area))])])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"设备编号"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("p",{staticClass:"TsMaxWidth"},[e._v(e._s(t.row.device_type))]),e._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("div",{staticClass:"overflowHide"},[e._v(e._s(t.row.device_type))])])])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"客户名称",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-popover",{attrs:{trigger:"hover",placement:"top"}},[a("p",{staticClass:"TsMaxWidth"},[e._v(e._s(t.row.customername))]),e._v(" "),a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[a("div",{staticClass:"overflowHide"},[e._v(e._s(t.row.customername))])])])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"",label:"操作",width:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top"}},[a("i",{staticClass:"icon-delete el-icon-delete",on:{click:function(a){e.deleteClick(t.row)}}})])]}}])})],1)],1),e._v(" "),a("div",{staticClass:"footer"},[a("el-pagination",{attrs:{background:"","current-page":e.paging.page,"page-sizes":[10,11,12],"page-size":e.paging.pageSize,layout:"sizes, prev, pager, next, jumper,total",total:e.paging.total},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange,"update:currentPage":function(t){e.$set(e.paging,"page",t)}}})],1)],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"header"},[t("div",{staticClass:"headerTitle"},[t("span",[this._v("发卡")])])])}]};var h=a("VU/8")(p,v,!1,function(e){a("dQbL")},"data-v-51c36396",null);t.default=h.exports}});