webpackJsonp([11],{E8iT:function(t,e){},KFnE:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("mw3O"),s=i.n(a),n=i("OMN4"),l=i.n(n),o={name:"page",data:function(){return{map:"",activeIndex:"1",province:["重庆市","北京市","江西省","陕西省","吉林省","浙江省","广东省","河南省","贵州省","河北省","青海省","福建省","辽宁省","海南省","台湾省","江苏省","湖南省","西藏自治区","内蒙古自治区","新疆维吾尔自治区","四川省","天津市","山东省","甘肃省","黑龙江省","安徽省","广西壮族自治区","上海市","湖北省","云南省","山西省","宁夏回族自治区"],custom:[],changeList:{enclId:"",enclName:"",enclLong:"",enclDimen:"",endRadius:"",positionerid:""},circle:"",add:!1,addx:!1,change:!1,changex:!1,title:"",addList:{enclName:"",enclLong:"",enclDimen:"",endRadius:"",positionerid:""},addxList:{positionerid:"",enclSpe:""},data:[],defaultProps:{children:"children",label:"positionerId"},datas:[]}},mounted:function(){document.title=this.$route.meta.title;var t=this;t.customList(),t.map=new BMap.Map("allmap"),t.map.setMapStyle({styleJson:[{featureType:"water",elementType:"all",stylers:{color:"#95c0fdff"}},{featureType:"land",elementType:"all",stylers:{color:"#ffffffff"}}]});var e=new BMap.Point(120.21937542,30.25924446);t.map.centerAndZoom(e,15),(new BMap.Geolocation).getCurrentPosition(function(e){this.getStatus()==BMAP_STATUS_SUCCESS?(t.map.centerAndZoom(e.point,15),t.map.enableScrollWheelZoom()):alert("failed"+this.getStatus())},{enableHighAccuracy:!0}),this.map.addEventListener("click",function(e){t.map.clearOverlays(),t.circle=new BMap.Circle(e.point,1e3,{strokeColor:"#00ffcc",strokeWeight:2,fillColor:"#00ffcc",fillOpacity:"0.5"}),t.map.addOverlay(t.circle),t.circle.enableEditing()})},methods:{addxClick:function(){var t=this;l()({method:"post",url:this.$store.state.http+"/enclose/add",data:s.a.stringify(this.addxList)}).then(function(e){0==e.data.resCode&&(t.$message({message:"添加成功",type:"success"}),t.addx=!1)})},getBoundary:function(t,e){var i=this;i.dataList(),i.addxList.enclSpe=t,(new BMap.Boundary).get(t,function(t){i.map.clearOverlays();var a=t.boundaries.length;if(0!==a){var s=[];if(0==e){i.addx=!0;for(var n=0;n<a;n++){var l=new BMap.Polygon(t.boundaries[n],{strokeWeight:2,strokeColor:"#ff0000"});i.map.addOverlay(l),s=s.concat(l.getPath()),i.map.setViewport(s)}}else{for(var o=0;o<a;o++){var c=new BMap.Polygon(t.boundaries[o],{strokeWeight:2,strokeColor:"#ff0000"});s=s.concat(c.getPath())}i.map.setViewport(s)}}else alert("未能获取当前输入行政区域")})},handleSelect:function(t,e){this.activeIndex=t},addEnclosure:function(){this.circle&&(this.dataList(),this.add=!0,this.addList.enclLong=this.circle.getCenter().lng,this.addList.enclDimen=this.circle.getCenter().lat,this.addList.endRadius=parseInt(this.circle.getRadius(),10),this.addList.userId=sessionStorage.getItem("userId"))},dataList:function(){var t=this;l()({method:"post",url:this.$store.state.http+"/group/groupByCar",data:s.a.stringify({userId:sessionStorage.getItem("userId")})}).then(function(e){if(t.data=e.data.result,0==e.data.resCode)for(var i=0,a=e.data.result.length;i<a;i++)t.data[i].positionerId=e.data.result[i].agroup;else t.data=[]})},handleNodeClick:function(t){t.children||(this.addList.positionerid=t.positionerId,this.addxList.positionerid=t.positionerId,this.changeList.positionerid=t.positionerId)},addClick:function(){var t=this;l()({method:"post",url:this.$store.state.http+"/enclose/add",data:s.a.stringify(this.addList)}).then(function(e){0==e.data.resCode&&(t.$message({message:"添加成功",type:"success"}),t.add=!1,t.customList())})},customList:function(){var t=this;l()({method:"post",url:this.$store.state.http+"/enclose/list",data:s.a.stringify({userId:sessionStorage.getItem("userId")})}).then(function(e){0==e.data.resCode&&(t.custom=e.data.result)})},changeCustom:function(t){this.changeList={enclId:this.custom[t].enclId,enclName:this.custom[t].enclName,enclLong:this.custom[t].enclLong,enclDimen:this.custom[t].enclDimen,endRadius:this.custom[t].endRadius,positionerid:this.custom[t].positionerid},this.change=!0,this.dataList()},changeClick:function(){var t=this;l()({method:"post",url:this.$store.state.http+"/enclose/updateById",data:s.a.stringify(this.changeList)}).then(function(e){0==e.data.resCode?(t.$message({message:"修改成功",type:"success"}),t.change=!1,t.customList()):t.$message({message:"修改失败",type:"warning"})})},changexCity:function(t){this.title=t;var e=this;l()({method:"post",url:this.$store.state.http+"/enclose/listByenclSpe",data:s.a.stringify({enclSpe:t})}).then(function(t){0==t.data.resCode&&(e.changex=!0,e.datas=t.data.result)})},deleteCustom:function(t){var e=this,i=this;this.$confirm("此操作将永久删除该条数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){l()({method:"post",url:e.$store.state.http+"/enclose/deleById",data:s.a.stringify({enclId:t})}).then(function(t){0==t.data.resCode?(i.customList(),i.$message({message:"删除成功",type:"success"}),i.changexCity(i.title)):i.$alert(t.data.result,"系统确认框",{confirmButtonText:"确定"})})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})}}},c={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"fenceSet"}},[t._m(0),t._v(" "),i("div",{staticClass:"titleLeft"},[i("el-menu",{staticClass:"el-menu-demo",attrs:{"default-active":t.activeIndex,mode:"horizontal","text-color":"#ccc","active-text-color":"#67C23A"},on:{select:t.handleSelect}},[i("el-row",[i("el-col",{staticClass:"titleChoice",attrs:{span:12}},[i("el-menu-item",{attrs:{index:"1"}},[t._v("自定义围栏")])],1),t._v(" "),i("el-col",{staticClass:"titleChoice",attrs:{span:12}},[i("el-menu-item",{attrs:{index:"2"}},[t._v("行政区域围栏")])],1)],1)],1),t._v(" "),1==t.activeIndex?i("div",{staticClass:"height"},[t._m(1),t._v(" "),t._l(t.custom,function(e,a){return i("div",{staticClass:"head"},[i("div",{on:{click:function(t){}}},[t._v(t._s(e.enclName))]),i("div",[i("i",{staticClass:"el-icon-edit-outline",staticStyle:{"font-size":"16px"},on:{click:function(e){t.changeCustom(a)}}}),i("i",{staticClass:"el-icon-delete",staticStyle:{"font-size":"16px"},on:{click:function(i){t.deleteCustom(e.enclId)}}})])])})],2):t._e(),t._v(" "),2==t.activeIndex?i("div",{staticClass:"height"},[t._m(2),t._v(" "),t._l(t.province,function(e,a){return i("div",{staticClass:"head"},[i("div",{on:{click:function(i){t.getBoundary(e,0)}}},[t._v(t._s(e))]),i("div",[i("i",{staticClass:"el-icon-edit-outline",staticStyle:{"font-size":"16px"},on:{click:function(i){t.changexCity(e)}}}),i("i",{staticClass:"el-icon-location-outline",staticStyle:{"font-size":"16px"},on:{click:function(i){t.getBoundary(e,1)}}})])])})],2):t._e(),t._v(" "),i("div",{staticClass:"posi"},[i("el-button",{on:{click:t.addEnclosure}},[t._v("添加围栏")]),i("br"),i("br"),t._v(" "),i("el-button",{on:{click:function(e){t.map.clearOverlays()}}},[t._v("取消")])],1)],1),t._v(" "),i("el-dialog",{attrs:{title:"添加自定义围栏",visible:t.add},on:{"update:visible":function(e){t.add=e}}},[i("div",{staticStyle:{display:"flex"}},[i("div",{staticStyle:{"text-align":"right",width:"40%","margin-right":"10%"}},[i("span",[t._v("围栏名称：")]),t._v(" "),i("el-input",{attrs:{disabled:!1,clearable:"",placeholder:"请输入内容"},model:{value:t.addList.enclName,callback:function(e){t.$set(t.addList,"enclName",e)},expression:"addList.enclName"}}),i("br"),i("br"),t._v(" "),i("span",[t._v("经度：")]),t._v(" "),i("el-input",{attrs:{disabled:!0,clearable:"",placeholder:"请输入内容"},model:{value:t.addList.enclLong,callback:function(e){t.$set(t.addList,"enclLong",e)},expression:"addList.enclLong"}}),i("br"),i("br"),t._v(" "),i("span",[t._v("纬度：")]),t._v(" "),i("el-input",{attrs:{disabled:!0,clearable:"",placeholder:"请输入内容"},model:{value:t.addList.enclDimen,callback:function(e){t.$set(t.addList,"enclDimen",e)},expression:"addList.enclDimen"}}),i("br"),i("br"),t._v(" "),i("span",[t._v("半径：")]),t._v(" "),i("el-input",{attrs:{disabled:!0,clearable:"",placeholder:"请输入内容"},model:{value:t.addList.endRadius,callback:function(e){t.$set(t.addList,"endRadius",e)},expression:"addList.endRadius"}}),i("br"),i("br"),t._v(" "),i("span",[t._v("设备：")]),t._v(" "),i("el-input",{attrs:{disabled:!0,clearable:"",placeholder:"请输入内容"},model:{value:t.addList.positionerid,callback:function(e){t.$set(t.addList,"positionerid",e)},expression:"addList.positionerid"}})],1),t._v(" "),i("div",{staticStyle:{"text-align":"center",width:"50%"}},[i("el-tree",{attrs:{data:t.data,accordion:!0,"node-key":"group",props:t.defaultProps},on:{"node-click":t.handleNodeClick}})],1)]),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.add=!1}}},[t._v("取消")]),t._v(" "),i("el-button",{on:{click:t.addClick}},[t._v("保存")])],1)]),t._v(" "),i("el-dialog",{attrs:{title:"添加行政区域围栏",visible:t.addx},on:{"update:visible":function(e){t.addx=e}}},[i("div",{staticStyle:{display:"flex"}},[i("div",{staticStyle:{"text-align":"right",width:"40%","margin-right":"10%"}},[i("span",[t._v("行政区：")]),t._v(" "),i("el-input",{attrs:{disabled:!0,clearable:"",placeholder:"请输入内容"},model:{value:t.addxList.enclSpe,callback:function(e){t.$set(t.addxList,"enclSpe",e)},expression:"addxList.enclSpe"}}),i("br"),i("br"),t._v(" "),i("span",[t._v("设备：")]),t._v(" "),i("el-input",{attrs:{disabled:!0,clearable:"",placeholder:"请输入内容"},model:{value:t.addxList.positionerid,callback:function(e){t.$set(t.addxList,"positionerid",e)},expression:"addxList.positionerid"}})],1),t._v(" "),i("div",{staticStyle:{"text-align":"center",width:"50%"}},[i("el-tree",{attrs:{data:t.data,accordion:!0,"node-key":"group",props:t.defaultProps},on:{"node-click":t.handleNodeClick}})],1)]),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.addx=!1}}},[t._v("取消")]),t._v(" "),i("el-button",{on:{click:t.addxClick}},[t._v("保存")])],1)]),t._v(" "),i("el-dialog",{attrs:{title:"修改自定义围栏",visible:t.change},on:{"update:visible":function(e){t.change=e}}},[i("div",{staticStyle:{display:"flex"}},[i("div",{staticStyle:{"text-align":"right",width:"40%","margin-right":"10%"}},[i("span",[t._v("围栏名称：")]),t._v(" "),i("el-input",{attrs:{disabled:!1,clearable:"",placeholder:"请输入内容"},model:{value:t.changeList.enclName,callback:function(e){t.$set(t.changeList,"enclName",e)},expression:"changeList.enclName"}}),i("br"),i("br"),t._v(" "),i("span",[t._v("经度：")]),t._v(" "),i("el-input",{attrs:{disabled:!0,clearable:"",placeholder:"请输入内容"},model:{value:t.changeList.enclLong,callback:function(e){t.$set(t.changeList,"enclLong",e)},expression:"changeList.enclLong"}}),i("br"),i("br"),t._v(" "),i("span",[t._v("纬度：")]),t._v(" "),i("el-input",{attrs:{disabled:!0,clearable:"",placeholder:"请输入内容"},model:{value:t.changeList.enclDimen,callback:function(e){t.$set(t.changeList,"enclDimen",e)},expression:"changeList.enclDimen"}}),i("br"),i("br"),t._v(" "),i("span",[t._v("半径：")]),t._v(" "),i("el-input",{attrs:{disabled:!0,clearable:"",placeholder:"请输入内容"},model:{value:t.changeList.endRadius,callback:function(e){t.$set(t.changeList,"endRadius",e)},expression:"changeList.endRadius"}}),i("br"),i("br"),t._v(" "),i("span",[t._v("设备：")]),t._v(" "),i("el-input",{attrs:{disabled:!0,clearable:"",placeholder:"请输入内容"},model:{value:t.changeList.positionerid,callback:function(e){t.$set(t.changeList,"positionerid",e)},expression:"changeList.positionerid"}})],1),t._v(" "),i("div",{staticStyle:{"text-align":"center",width:"50%"}},[i("el-tree",{attrs:{data:t.data,accordion:!0,"node-key":"group",props:t.defaultProps},on:{"node-click":t.handleNodeClick}})],1)]),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.change=!1}}},[t._v("取消")]),t._v(" "),i("el-button",{on:{click:t.changeClick}},[t._v("保存")])],1)]),t._v(" "),i("el-dialog",{attrs:{title:t.title,visible:t.changex},on:{"update:visible":function(e){t.changex=e}}},[i("div",{staticStyle:{display:"flex"}},[i("div",{staticStyle:{"text-align":"center",width:"60%",padding:"0 20%","max-height":"300px","overflow-y":"scroll"}},t._l(t.datas,function(e){return i("p",{staticClass:"p"},[i("span",[t._v(t._s(e.positionerid))]),i("span",{staticStyle:{"margin-left":"20%"}},[i("i",{staticClass:"el-icon-delete",on:{click:function(i){t.deleteCustom(e.enclId)}}})])])}))]),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.changex=!1}}},[t._v("取消")])],1)])],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"titleRight"},[e("div",{attrs:{id:"allmap"}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"head"},[e("div",[this._v("围栏名称")]),e("div",[this._v("操作")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"head"},[e("div",[this._v("围栏名称")]),e("div",[this._v("操作")])])}]};var d=i("VU/8")(o,c,!1,function(t){i("E8iT")},"data-v-bb16bb1c",null);e.default=d.exports}});