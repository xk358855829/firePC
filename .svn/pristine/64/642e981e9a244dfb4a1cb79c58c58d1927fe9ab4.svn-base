webpackJsonp([7],{F5wD:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var s=t("mvHQ"),n=t.n(s),i=t("mw3O"),o=t.n(i),r=t("OMN4"),d=t.n(r),l=(t("7t+N"),t("UMo0")),c=t("pIod"),u=t.n(c),v=t("2UA+"),m={name:"equipmentList",data:function(){return{universal:{onfile:!1,statistic:!1},inputDev:"",mapchangelist:[],mapchangelistlp:[],mapchangelists:[],maxLists:[],con:{devVOL:"",waterMeter:"",waterTemperature:"",devDefence:"",devUnlockWay:"",devLockState:"",waterMeterTotal:"",waterMeterTemp:"",devHardVerison:"",waterPressure:"",devSoftVerison:"",devParaSn:"",devWarning:"",devIccid:"",devLongitude:"",devStatus:"",devLatitude:"",devUnlockTime:"",waterMeterTrip:""},value1:"",value2:"",value3:"",value4:"",value8:"",value9:"",value15:"",value16:"",lice:"",lace:"",ying:"",newmes:"",roomid:""}},mounted:function(){document.title=this.$route.meta.title,void 0==this.$route.query.mouse||(this.inputDev=this.$route.query.mouse,this.mappInput()),document.getElementById("allmap").style.height=document.body.clientHeight-70+"px";var e=this;e.map=new BMap.Map("allmap"),e.map.setMapStyle({styleJson:[{featureType:"land",elementType:"all",stylers:{color:"#ccccccff",hue:"#000000"}},{featureType:"boundary",elementType:"geometry.fill",stylers:{color:"#999999ff"}}]});var a=new BMap.Point(120.21937542,30.25924446);e.map.centerAndZoom(a,5),e.map.enableScrollWheelZoom();var t=sessionStorage.getItem("dealer");0==t&&(t=sessionStorage.getItem("orderDealers"));var s={pageNum:1,pageSize:1e5,userId:sessionStorage.getItem("userId"),dealer:t};d()({method:"post",url:"http://39.104.113.112:8796/devices/conditionFind",data:o.a.stringify(s)}).then(function(a){if(0==a.data.resCode)for(var t=[],s=function(s){var n=a.data.result[s].deviceId;d()({method:"post",url:"http://39.104.113.112:8796/Datapoints/getData",data:o.a.stringify({devId:a.data.result[s].deviceId})}).then(function(a){var s=JSON.parse(a.data.errMsg.slice(6));if(0==a.data.resCode){for(var i="",o="",r={},d=0;d<s.data.datastreams.length;d++)"2002"==s.data.datastreams[d].id&&(i=s.data.datastreams[d].datapoints[0].value/1e5),"2003"==s.data.datastreams[d].id&&(o=s.data.datastreams[d].datapoints[0].value/1e5);e.mapchangelist=Object(v.b)(o,i),r.lat=e.mapchangelist[1],r.lng=e.mapchangelist[0],.008728984041221487!=r.lat&&.02200129584349762!=r.lng||(r.lat=30.2693046269,r.lng=120.2282128307),r.id=n,t.push(r)}for(var l=t.length,c=[],m=null,p=0;p<l;p++){m=new BMap.Point(t[p].lng,t[p].lat);var g=new BMap.Marker(m),h=new BMap.Size(16,26),f=new BMap.Icon(u.a,h,{imageSize:h});g=new BMap.Marker(m,{icon:f}),e.addClickHandler("设备编号:"+t[p].id,g),c.push(g)}new BMapLib.MarkerClusterer(e.map,{markers:c})})},n=0;n<a.data.result.length;n++)s(n)})},methods:{statistics:function(){this.universal.statistic=!0;""==this.value1?this.value1=this.common.getNowFormatDatenew():this.value1=n()(this.value1).slice(1,20).replace(" ","T"),""==this.value2?this.value2=this.common.getNowFormatDate():this.value2=n()(this.value2).slice(1,20).replace(" ","T"),this.elding(),""==this.value3?this.value3=this.common.getNowFormatDatenew():this.value3=n()(this.value3).slice(1,20).replace(" ","T"),""==this.value4?this.value4=this.common.getNowFormatDate():this.value4=n()(this.value4).slice(1,20).replace(" ","T"),this.elding1(),""==this.value8?this.value8=this.common.getNowFormatDatenew():this.value8=n()(this.value8).slice(1,20).replace(" ","T"),""==this.value9?this.value9=this.common.getNowFormatDate():this.value9=n()(this.value9).slice(1,20).replace(" ","T"),this.elding2(),""==this.value15?this.value15=this.common.getNowFormatDatenew():this.value15=n()(this.value15).slice(1,20),""==this.value16?this.value16=this.common.getNowFormatDate():this.value16=n()(this.value16).slice(1,20),this.elding3()},elding:function(){var e=[],a=[],t={devId:this.roomid,start:this.value1,end:this.value2,datastreamIds:"2005"};d()({method:"post",url:this.$store.state.http+"/Datapoints/getHistoryData",data:o.a.stringify(t)}).then(function(t){for(var s=JSON.parse(t.data.errMsg.slice(6)),n=0;n<s.data.datastreams.length;n++)if("2005"==s.data.datastreams[n].id)for(var i=s.data.datastreams[n].datapoints,o=0;o<i.length;o++)a.push(i[o].at.slice(0,19)),e.push(i[o].value/100);echarts.init(document.getElementById("main3")).setOption({dataZoom:[{show:!0,realtime:!0,start:0,end:100},{type:"inside",realtime:!0,start:0,end:100}],tooltip:{trigger:"axis",axisPointer:{type:"cross"}},xAxis:[{type:"category",boundaryGap:!1,data:a.map(function(e){return e.replace(" ","\n")})}],yAxis:[{name:"",type:"value"}],grid:{bottom:"10%",containLabel:!0},series:[{name:"水压",type:"line",markArea:{},data:e}]})})},elding3:function(){var e=[],a=[];d()({method:"post",url:this.$store.state.http+"/Datapoints/getHistoryData",data:o.a.stringify({devId:this.roomid,start:this.value15,end:this.value16,datastreamIds:"2001"})}).then(function(t){for(var s=JSON.parse(t.data.errMsg.slice(6)),n=0;n<s.data.datastreams.length;n++)if("2001"==s.data.datastreams[n].id)for(var i=s.data.datastreams[n].datapoints,o=0;o<i.length;o++)a.push(i[o].at.slice(0,19)),e.push(i[o].value);echarts.init(document.getElementById("main8")).setOption({dataZoom:[{show:!0,realtime:!0,start:0,end:100},{type:"inside",realtime:!0,start:0,end:100}],tooltip:{trigger:"axis",axisPointer:{type:"cross"}},xAxis:[{type:"category",boundaryGap:!1,data:a.map(function(e){return e.replace(" ","\n")})}],yAxis:[{name:"",type:"value"}],grid:{bottom:"10%",containLabel:!0},series:[{name:"电压",type:"line",markArea:{},data:e}]})})},elding1:function(){var e=[],a=[],t={devId:this.roomid,start:this.value1,end:this.value4,datastreamIds:"2006"};d()({method:"post",url:this.$store.state.http+"/Datapoints/getHistoryData",data:o.a.stringify(t)}).then(function(t){for(var s=JSON.parse(t.data.errMsg.slice(6)),n=0;n<s.data.datastreams.length;n++)if("2006"==s.data.datastreams[n].id)for(var i=s.data.datastreams[n].datapoints,o=0;o<i.length;o++)a.push(i[o].at.slice(0,19)),e.push(i[o].value);echarts.init(document.getElementById("main4")).setOption({dataZoom:[{show:!0,realtime:!0,start:0,end:100},{type:"inside",realtime:!0,start:0,end:100}],tooltip:{trigger:"axis",axisPointer:{type:"cross"}},xAxis:[{type:"category",boundaryGap:!1,data:a.map(function(e){return e.replace(" ","\n")})}],yAxis:[{name:"",type:"value"}],grid:{bottom:"10%",containLabel:!0},series:[{name:"水流量",type:"line",markArea:{},data:e}]})})},elding2:function(){var e=[],a=[];d()({method:"post",url:this.$store.state.http+"/Datapoints/getHistoryData",data:o.a.stringify({devId:this.roomid,start:this.value8,end:this.value9,datastreamIds:"2004"})}).then(function(t){for(var s=JSON.parse(t.data.errMsg.slice(6)),n=0;n<s.data.datastreams.length;n++)if("2004"==s.data.datastreams[n].id)for(var i=s.data.datastreams[n].datapoints,o=0;o<i.length;o++)a.push(i[o].at.slice(0,19)),e.push(i[o].value/10);echarts.init(document.getElementById("main5")).setOption({dataZoom:[{show:!0,realtime:!0,start:0,end:100},{type:"inside",realtime:!0,start:0,end:100}],tooltip:{trigger:"axis",axisPointer:{type:"cross"}},xAxis:[{type:"category",boundaryGap:!1,data:a.map(function(e){return e.replace(" ","\n")})}],yAxis:[{name:"",type:"value"}],grid:{bottom:"10%",containLabel:!0},series:[{name:"水温",type:"line",markArea:{},data:e}]})})},changestatu:function(e){var a=this,t=this;if("已激活"==t.value5)t.value5="已激活",this.$confirm("此操作将设备激活, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.listLoading=!0,t.universal.look=!1,t.universal.onfile=!1;var e={devId:t.roomid,cmd:17,cmdValue:"12"};d()({method:"post",url:t.$store.state.http+"/send/sendCmd",data:o.a.stringify(e)}).then(function(e){if(0==e.data.resCode)var a=setTimeout(function(){var e={devId:t.roomid};Object(l.a)("/Datapoints/getData",e).then(function(e){for(var s=JSON.parse(e.data.errMsg.slice(6)),n=0;n<s.data.datastreams.length;n++)switch(s.data.datastreams[n].id){case"2012":t.con.devControl=s.data.datastreams[n].datapoints[0].value}if(17==t.con.devControl){clearTimeout(a);var i=setTimeout(function(){var e={devId:t.roomid};Object(l.a)("/Datapoints/getData",e).then(function(e){for(var a=JSON.parse(e.data.errMsg.slice(6)),s=0;s<a.data.datastreams.length;s++)switch(a.data.datastreams[s].id){case"2012":t.con.devControl=a.data.datastreams[s].datapoints[0].value}if(17==t.con.devControl){clearTimeout(i);var n=setTimeout(function(){var e={devId:t.roomid};Object(l.a)("/Datapoints/getData",e).then(function(e){for(var a=JSON.parse(e.data.errMsg.slice(6)),s=0;s<a.data.datastreams.length;s++)switch(a.data.datastreams[s].id){case"2012":t.con.devControl=a.data.datastreams[s].datapoints[0].value}17==t.con.devControl?(t.value5="未激活",t.hidestatus=!1,clearTimeout(n),t.$message({message:"激活超时",type:"error"}),t.listLoading=!1,t.universal.onfile=!0,t.universal.look=!0):(t.listLoading=!1,t.universal.onfile=!0,t.universal.look=!0,clearTimeout(n),t.value5="已激活",t.hidestatus=!0,t.$message({message:"激活成功",type:"success"}))})})}else t.listLoading=!1,t.universal.onfile=!0,t.universal.look=!0,clearTimeout(i),t.value5="已激活",t.hidestatus=!0,t.$message({message:"激活成功",type:"success"})})},5e3)}else t.listLoading=!1,t.universal.onfile=!0,t.universal.look=!0,clearTimeout(a),t.value5="已激活",t.hidestatus=!0,t.$message({message:"激活成功",type:"success"})})},5e3);else t.listLoading=!1,t.universal.onfile=!0,t.universal.look=!0,clearTimeout(timer),t.value5="已激活",t.hidestatus=!0,t.$message({message:"激活成功",type:"success"})})}).catch(function(){a.$message({type:"info",message:"已取消激活"}),t.value5="未激活"});else if("未激活"==t.value5){var s={devId:t.roomid};t.value5="未激活",this.$confirm("此操作将设备停用, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.listLoading=!0,t.universal.look=!1,t.universal.onfile=!1;var e={devId:t.roomid,cmd:17,cmdValue:"11"};d()({method:"post",url:t.$store.state.http+"/send/sendCmd",data:o.a.stringify(e)}).then(function(e){if(0==e.data.resCode)var a=setTimeout(function(){Object(l.a)("/Datapoints/getData",s).then(function(e){for(var n=JSON.parse(e.data.errMsg.slice(6)),i=0;i<n.data.datastreams.length;i++)switch(n.data.datastreams[i].id){case"2012":t.con.devControl=n.data.datastreams[i].datapoints[0].value}if(17==t.con.devControl)clearTimeout(a),t.value5="未激活",t.hidestatus=!1,t.listLoading=!1,t.universal.onfile=!0,t.universal.look=!0,t.$message({message:"停用成功",type:"success"});else{clearTimeout(a);var o=setTimeout(function(){Object(l.a)("/Datapoints/getData",s).then(function(e){for(var a=JSON.parse(e.data.errMsg.slice(6)),n=0;n<a.data.datastreams.length;n++)switch(a.data.datastreams[n].id){case"2012":t.con.devControl=a.data.datastreams[n].datapoints[0].value}if(17==t.con.devControl)clearTimeout(o),t.value5="未激活",t.hidestatus=!1,t.listLoading=!1,t.universal.onfile=!0,t.universal.look=!0,t.$message({message:"停用成功",type:"success"});else{clearTimeout(o);var i=setTimeout(function(){Object(l.a)("/Datapoints/getData",s).then(function(e){for(var a=JSON.parse(e.data.errMsg.slice(6)),s=0;s<a.data.datastreams.length;s++)switch(a.data.datastreams[s].id){case"2012":t.con.devControl=a.data.datastreams[s].datapoints[0].value}17==t.con.devControl?(clearTimeout(i),t.value5="未激活",t.hidestatus=!1,t.listLoading=!1,t.universal.onfile=!0,t.universal.look=!0,t.$message({message:"停用成功",type:"success"})):(clearTimeout(i),t.value5="已激活",t.listLoading=!1,t.universal.onfile=!0,t.universal.look=!0,t.hidestatus=!0,t.$message({message:"停用超时",type:"error"}))})},5e3)}})},5e3)}})},5e3);else t.listLoading=!1,t.universal.onfile=!0,t.universal.look=!0,t.value5="已激活",t.hidestatus=!0,t.$message({message:"停用失败",type:"success"})})}).catch(function(){a.$message({type:"info",message:"已取消停用"}),t.value5="已激活"})}},changelock:function(e){var a=this;"已开阀"==a.value6?(a.value6="已开阀",this.$confirm("此操作将设备开阀, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.listLoading=!0,a.universal.look=!1,a.universal.onfile=!1;var e={devId:a.roomid,cmd:18,cmdValue:"11"};d()({method:"post",url:a.$store.state.http+"/send/sendCmd",data:o.a.stringify(e)}).then(function(e){if(0==e.data.resCode)var t=setTimeout(function(){var e={devId:a.roomid};Object(l.a)("/Datapoints/getData",e).then(function(e){for(var s=JSON.parse(e.data.errMsg.slice(6)),n=0;n<s.data.datastreams.length;n++)switch(s.data.datastreams[n].id){case"2008":a.con.devLockState=s.data.datastreams[n].datapoints[0].value}if(17==a.con.devLockState)a.value6="已开阀",a.listLoading=!1,a.universal.onfile=!0,a.universal.look=!0,clearTimeout(t),a.$message({message:"开阀成功",type:"success"});else{clearTimeout(t);var i=setInterval(function(){var e={devId:a.roomid};Object(l.a)("/Datapoints/getData",e).then(function(e){for(var t=JSON.parse(e.data.errMsg.slice(6)),s=0;s<t.data.datastreams.length;s++)switch(t.data.datastreams[s].id){case"2008":a.con.devLockState=t.data.datastreams[s].datapoints[0].value}if(17==a.con.devLockState)a.value6="已开阀",a.listLoading=!1,a.universal.onfile=!0,a.universal.look=!0,clearTimeout(i),a.$message({message:"开阀成功",type:"success"});else{clearTimeout(i);var n=setInterval(function(){var e={devId:a.roomid};Object(l.a)("/Datapoints/getData",e).then(function(e){for(var t=JSON.parse(e.data.errMsg.slice(6)),s=0;s<t.data.datastreams.length;s++)switch(t.data.datastreams[s].id){case"2008":a.con.devLockState=t.data.datastreams[s].datapoints[0].value}17==a.con.devLockState?(a.value6="已开阀",a.listLoading=!1,a.universal.onfile=!0,a.universal.look=!0,clearTimeout(n),a.$message({message:"开阀成功",type:"success"})):(clearTimeout(n),a.listLoading=!1,a.universal.onfile=!0,a.universal.look=!0,a.value6="未开阀",a.$message({message:"开阀超时",type:"error"}))})},5e3)}})},5e3)}})},5e3);else a.listLoading=!1,a.universal.onfile=!0,a.universal.look=!0,a.value6="未开阀",a.$message({message:"开阀失败",type:"error"})})}).catch(function(){a.$message({type:"info",message:"已取消开阀"}),a.value6="未开阀"})):"未开阀"==a.value6&&(a.value6="未开阀",a.$confirm("此操作将设备关阀, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.listLoading=!0,a.universal.look=!1,a.universal.onfile=!1;var e={devId:a.roomid,cmd:18,cmdValue:"12"};d()({method:"post",url:a.$store.state.http+"/send/sendCmd",data:o.a.stringify(e)}).then(function(e){if(0==e.data.resCode)var t=setTimeout(function(){var e={devId:a.roomid};Object(l.a)("/Datapoints/getData",e).then(function(e){for(var s=JSON.parse(e.data.errMsg.slice(6)),n=0;n<s.data.datastreams.length;n++)switch(s.data.datastreams[n].id){case"2008":a.con.devControl=s.data.datastreams[n].datapoints[0].value}if("开启"!=a.con.devLockState){clearTimeout(t);var i=setInterval(function(){var e={devId:a.roomid};Object(l.a)("/Datapoints/getData",e).then(function(e){for(var t=JSON.parse(e.data.errMsg.slice(6)),s=0;s<t.data.datastreams.length;s++)switch(t.data.datastreams[s].id){case"2008":a.con.devControl=t.data.datastreams[s].datapoints[0].value}if("开启"!=a.con.devLockState){clearTimeout(i);var n=setInterval(function(){var e={devId:a.roomid};Object(l.a)("/Datapoints/getData",e).then(function(e){for(var t=JSON.parse(e.data.errMsg.slice(6)),s=0;s<t.data.datastreams.length;s++)switch(t.data.datastreams[s].id){case"2008":a.con.devControl=t.data.datastreams[s].datapoints[0].value}"开启"!=a.con.devLockState?(a.value6="已开阀",clearTimeout(n),a.listLoading=!1,a.universal.onfile=!0,a.universal.look=!0,a.$message({message:"关阀超时",type:"error"})):(a.value6="未开阀",clearTimeout(n),a.listLoading=!1,a.universal.onfile=!0,a.universal.look=!0,a.$message({message:"关阀成功",type:"success"}))})})}else a.value6="未开阀",clearTimeout(i),a.listLoading=!1,a.universal.onfile=!0,a.universal.look=!0,a.$message({message:"关阀成功",type:"success"})},5e3)})}else a.value6="未开阀",clearTimeout(t),a.listLoading=!1,a.universal.onfile=!0,a.universal.look=!0,a.$message({message:"关阀成功",type:"success"})})},5e3);else a.value6="已开阀",a.listLoading=!1,a.universal.onfile=!0,a.universal.look=!0,a.$message({message:"关阀失败",type:"error"})})}).catch(function(){a.$message({type:"info",message:"已取消关阀"}),a.value6="已开阀"}))},changeting:function(e){var a=this,t=this;"已布防"==t.value7?(t.value7="已布防",this.$confirm("此操作将设备布防, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.listLoading=!0,t.universal.onfile=!1,t.universal.look=!1;var e={devId:t.roomid,cmd:19,cmdValue:"11"};d()({method:"post",url:t.$store.state.http+"/send/sendCmd",data:o.a.stringify(e)}).then(function(e){if(0==e.data.resCode)var a=setTimeout(function(){var e={devId:t.roomid};Object(l.a)("/Datapoints/getData",e).then(function(e){for(var s=JSON.parse(e.data.errMsg.slice(6)),n=0;n<s.data.datastreams.length;n++){switch(s.data.datastreams[n].id){case"2010":t.con.devDefence=s.data.datastreams[n].datapoints[0].value}"未布防"==t.con.devDefence?function(){clearTimeout(a);var e=setTimeout(function(){var a={devId:t.roomid};Object(l.a)("/Datapoints/getData",a).then(function(a){for(var s=JSON.parse(a.data.errMsg.slice(6)),n=0;n<s.data.datastreams.length;n++){switch(s.data.datastreams[n].id){case"2010":t.con.devDefence=s.data.datastreams[n].datapoints[0].value}"未布防"==t.con.devDefence?function(){clearTimeout(e);var a=setTimeout(function(){var e={devId:t.roomid};Object(l.a)("/Datapoints/getData",e).then(function(e){for(var s=JSON.parse(e.data.errMsg.slice(6)),n=0;n<s.data.datastreams.length;n++){switch(s.data.datastreams[n].id){case"2010":t.con.devDefence=s.data.datastreams[n].datapoints[0].value}"未布防"==t.con.devDefence?(t.value7="未布防",clearTimeout(a),t.listLoading=!1,t.universal.onfile=!0,t.universal.onfile=!0,t.$message({message:"布防超时",type:"error"})):(t.listLoading=!1,t.universal.onfile=!0,t.universal.onfile=!0,t.value7="已布防",clearTimeout(a),t.$message({message:"布防成功",type:"success"}))}})},5e3)}():(t.listLoading=!1,t.universal.onfile=!0,t.universal.onfile=!0,t.value7="已布防",clearTimeout(e),t.$message({message:"布防成功",type:"success"}))}})},5e3)}():(t.listLoading=!1,t.universal.onfile=!0,t.universal.onfile=!0,t.value7="已布防",clearTimeout(a),t.$message({message:"布防成功",type:"success"}))}})},5e3);else t.listLoading=!1,t.universal.onfile=!0,t.universal.onfile=!0,t.value7="未布防",t.$message({message:"布防失败",type:"error"})})}).catch(function(){a.$message({type:"info",message:"已取消布防"}),t.value7="未布防"})):"未布防"==t.value7&&(t.value7="未布防",this.$confirm("此操作将设备撤防, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.listLoading=!0,t.universal.look=!1,t.universal.onfile=!1;var e={devId:t.roomid,cmd:19,cmdValue:"12"};d()({method:"post",url:t.$store.state.http+"/send/sendCmd",data:o.a.stringify(e)}).then(function(e){if(0==e.data.resCode)var a=setTimeout(function(){var e={devId:t.roomid};Object(l.a)("/Datapoints/getData",e).then(function(e){for(var s=JSON.parse(e.data.errMsg.slice(6)),n=0;n<s.data.datastreams.length;n++){switch(s.data.datastreams[n].id){case"2010":t.con.devDefence=s.data.datastreams[n].datapoints[0].value}"未布防"==t.con.devDefence?function(){clearTimeout(a);var e=setTimeout(function(){var a={devId:t.roomid};Object(l.a)("/Datapoints/getData",a).then(function(a){for(var s=JSON.parse(a.data.errMsg.slice(6)),n=0;n<s.data.datastreams.length;n++){switch(s.data.datastreams[n].id){case"2010":t.con.devDefence=s.data.datastreams[n].datapoints[0].value}"未布防"==t.con.devDefence?function(){clearTimeout(e);var a=setTimeout(function(){var e={devId:t.roomid};Object(l.a)("/Datapoints/getData",e).then(function(e){for(var s=JSON.parse(e.data.errMsg.slice(6)),n=0;n<s.data.datastreams.length;n++){switch(s.data.datastreams[n].id){case"2010":t.con.devDefence=s.data.datastreams[n].datapoints[0].value}"未布防"==t.con.devDefence?(t.value7="已布防",t.listLoading=!1,t.universal.look=!0,t.universal.onfile=!0,clearTimeout(a),t.$message({message:"撤防超时",type:"error"})):(t.value7="未布防",t.listLoading=!1,t.universal.look=!0,t.universal.onfile=!0,clearTimeout(a),t.$message({message:"撤防成功",type:"success"}))}})},5e3)}():(t.value7="未布防",t.listLoading=!1,t.universal.look=!0,t.universal.onfile=!0,clearTimeout(e),t.$message({message:"撤防成功",type:"success"}))}})},5e3)}():(t.value7="未布防",t.listLoading=!1,t.universal.look=!0,t.universal.onfile=!0,clearTimeout(a),t.$message({message:"撤防成功",type:"success"}))}})},5e3);else t.value7="已布防",t.listLoading=!1,t.universal.look=!0,t.universal.onfile=!0,t.$message({message:"撤防失败",type:"error"})})}).catch(function(){a.$message({type:"info",message:"已取消撤防"}),t.value7="已布防"}))},recover:function(e){var a=this,t=this;this.$confirm("此操作将恢复出厂设置, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){d()({method:"post",url:a.$store.state.http+"/send/sendCmd",data:o.a.stringify({devId:t.roomid,cmd:22,cmdValue:"11"})}).then(function(e){if(0==e.data.resCode)setTimeout(function(){d()({method:"post",url:t.$store.state.http+"/send/QueryCmdsStatus",data:o.a.stringify({cmdsId:e.data.cmd_uuid})}).then(function(e){4==JSON.parse(e.data.errMsg.slice(4,e.data.errMsg.length)).data.status?t.$message({message:"恢复出厂设置成功",type:"success"}):0==JSON.parse(e.data.errMsg.slice(4,e.data.errMsg.length)).data.status?t.$message({message:"设备未在线",type:"error"}):t.$message({message:"恢复出厂设置失败",type:"error"})})},1e4);else t.$message({message:"恢复出厂设置失败",type:"error"})})}).catch(function(){a.$message({type:"info",message:"已取消恢复出厂设置"})})},read:function(e){var a=this,t=this;this.$confirm("此操作将读取定位信息, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){d()({method:"post",url:a.$store.state.http+"/send/sendCmd",data:o.a.stringify({devId:t.roomid,cmd:21,cmdValue:"11"})}).then(function(e){if(0==e.data.resCode)setTimeout(function(){d()({method:"post",url:t.$store.state.http+"/send/QueryCmdsStatus",data:o.a.stringify({cmdsId:e.data.cmd_uuid})}).then(function(e){4==JSON.parse(e.data.errMsg.slice(4,e.data.errMsg.length)).data.status?t.$message({message:"读取定位信息成功",type:"success"}):0==JSON.parse(e.data.errMsg.slice(4,e.data.errMsg.length)).data.status?t.$message({message:"设备未在线",type:"error"}):t.$message({message:"读取定位信息失败",type:"error"})})},1e4);else t.$message({message:"读取定位信息失败",type:"error"})})}).catch(function(){a.$message({type:"info",message:"已取消读取定位信息"})})},renewal:function(e){var a=this,t=this;this.$confirm("此操作将更新位置, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){d()({method:"post",url:a.$store.state.http+"/send/sendCmd",data:o.a.stringify({devId:t.roomid,cmd:21,cmdValue:"12"})}).then(function(e){if(0==e.data.resCode)setTimeout(function(){d()({method:"post",url:t.$store.state.http+"/send/QueryCmdsStatus",data:o.a.stringify({cmdsId:e.data.cmd_uuid})}).then(function(e){4==JSON.parse(e.data.errMsg.slice(4,e.data.errMsg.length)).data.status?t.$message({message:"更新位置成功",type:"success"}):0==JSON.parse(e.data.errMsg.slice(4,e.data.errMsg.length)).data.status?t.$message({message:"设备未在线",type:"error"}):t.$message({message:"更新位置失败",type:"error"})})},1e4);else t.$message({message:"更新位置失败",type:"error"})})}).catch(function(){a.$message({type:"info",message:"已取消更新位置"})})},mappInput:function(){var e={dealer:"123",devId:"",devParaSn:this.inputDev,deviceModel:"",pageNum:1,pageSize:10,personnel:"",userId:"331fa66faa314260a2d557c65e3e884b"},a=this;d()({method:"post",url:a.$store.state.http+"/devices/conditionFind",data:o.a.stringify(e)}).then(function(e){var t={devId:e.data.result[0].deviceId};d()({method:"post",url:a.$store.state.http+"/Datapoints/getData",data:o.a.stringify(t)}).then(function(t){for(var s=JSON.parse(t.data.errMsg.slice(6)),n=0;n<s.data.datastreams.length;n++)switch(s.data.datastreams[n].id){case"2003":a.lice=s.data.datastreams[n].datapoints[0].value;break;case"2002":a.lace=s.data.datastreams[n].datapoints[0].value}a.mapchangelists=Object(v.b)(a.lice/1e5,a.lace/1e5),a.lice=a.mapchangelists[1],a.lace=a.mapchangelists[0],.008728984041221487!=a.lice&&.02200129584349762!=a.lace||(a.lace=120.2282128307,a.lice=30.2693046269);var i={a:a.lice,b:a.lace};a.newmes="设备编号:"+e.data.result[0].deviceId,a.openInfo(a.newmes,i),setTimeout(function(){var e;e=new BMap.Point(i.b,i.a),a.map.centerAndZoom(e,18)},1e3)})})},contrloceie:function(e){this.$router.push({path:"/pageHome/faultList",query:{mouse:e.deviceIds}})},changecontrol:function(e){this.universal.onfile=!0;var a=this,t={devId:a.roomid};d()({method:"post",url:this.$store.state.http+"/Datapoints/getData",data:o.a.stringify(t)}).then(function(e){for(var t=JSON.parse(e.data.errMsg.slice(6)),s=0;s<t.data.datastreams.length;s++)switch(t.data.datastreams[s].id){case"2010":a.lon.devDefence=t.data.datastreams[s].datapoints[0].value;break;case"2012":a.lon.devControl=t.data.datastreams[s].datapoints[0].value;break;case"2009":a.lon.devUnlockWay=t.data.datastreams[s].datapoints[0].value,a.lon.devUnlockTime=t.data.datastreams[s].datapoints[0].at;break;case"2008":a.lon.devLockState=t.data.datastreams[s].datapoints[0].value;break;case"1001":a.lon.devStatus=t.data.datastreams[s].datapoints[0].value}17==a.lon.devControl?(a.value5="未激活",a.hidestatus=!1):(a.value5="已激活",a.hidestatus=!0),17==a.lon.devLockState?a.value6="已开阀":a.value6="未开阀",17==a.lon.devDefence?a.value7="未布防":a.value7="已布防"})},mapdetail:function(e){this.$router.push({path:"/pageHome/Edistribution",query:{mouse:e.devParaSn}})},addClickHandler:function(e,a){var t=this;a.addEventListener("click",function(a){t.openInfo(e,a)})},openInfo:function(e,a){var t=this,s=this;d()({method:"post",url:s.$store.state.http+"/devices/findsn",data:o.a.stringify({devId:e.slice(5,e.length)})}).then(function(e){0==e.data.resCode&&(""==e.data.i.devParaSn?s.ying="无":s.ying=e.data.i.devParaSn)}),Object(l.a)("/Datapoints/getData",{devId:e.slice(5,e.length)}).then(function(n){for(var i,o,r,d=JSON.parse(n.data.errMsg.slice(6)),l=0;l<d.data.datastreams.length;l++)switch(d.data.datastreams[l].id){case"2001":s.con.devVOL=d.data.datastreams[l].datapoints[0].value,s.con.devVOL=s.con.devVOL+"mv";break;case"2011":s.con.devWarning=d.data.datastreams[l].datapoints[0].value;break;case"2010":s.con.devDefence=d.data.datastreams[l].datapoints[0].value;break;case"2009":s.con.devUnlockWay=d.data.datastreams[l].datapoints[0].value,s.con.devUnlockTime=d.data.datastreams[l].datapoints[0].at;break;case"2008":s.con.devLockState=d.data.datastreams[l].datapoints[0].value;break;case"2007":s.con.waterMeterTotal=d.data.datastreams[l].datapoints[0].value,s.con.waterMeterTotal=s.con.waterMeterTotal+"m³";break;case"1005":s.con.devHardVerison=d.data.datastreams[l].datapoints[0].value;break;case"2006":s.con.waterMeterTemp=d.data.datastreams[l].datapoints[0].value,s.con.waterMeterTemp=s.con.waterMeterTemp+"m³";break;case"1004":s.con.devSoftVerison=d.data.datastreams[l].datapoints[0].value;break;case"2005":s.con.waterPressure=d.data.datastreams[l].datapoints[0].value;break;case"2004":s.con.waterTemperature=d.data.datastreams[l].datapoints[0].value/10,s.con.waterTemperature=s.con.waterTemperature+"℃";break;case"1002":s.con.devIccid=d.data.datastreams[l].datapoints[0].value;break;case"2003":s.con.devLongitude=d.data.datastreams[l].datapoints[0].value,s.con.devLongitude=s.con.devLongitude/1e5+"°";break;case"1001":s.con.devStatus=d.data.datastreams[l].datapoints[0].value;break;case"2002":s.con.devLatitude=d.data.datastreams[l].datapoints[0].value,s.con.devLatitude=s.con.devLatitude/1e5+"°"}s.con.devVOL>3550&&s.con.devVOL<4200?s.con.devVOL="正常":s.con.devVOL>3500&&s.con.devVOL<=3550?s.con.devVOL="低压":s.con.devVOL>3e3&&s.con.devVOL<=3500?s.con.devVOL="更换电池":s.con.devVOL="电量异常",""==s.con.waterPressure||"无数据"==s.con.waterPressure?s.con.waterPressure=s.con.waterPressure+"Mpa":s.con.waterPressure>=160||s.con.waterPressure<0?s.con.waterPressure="设备水压异常":s.con.waterPressure>=0||s.con.waterPressure<=30?s.con.waterPressure=((s.con.waterPressure+85)/10).toFixed(2)+"Mpa":s.con.waterPressure>30||s.con.waterPressure<=60?s.con.waterPressure=((s.con.waterPressure+105)/10).toFixed(2)+"Mpa":s.con.waterPressure>60||s.con.waterPressure<=90?s.con.waterPressure=((s.con.waterPressure+125)/10).toFixed(2)+"Mpa":(s.con.waterPressure>90||s.con.waterPressure<=159)&&(s.con.waterPressure=((s.con.waterPressure+155)/10).toFixed(2)+"Mpa"),17==s.con.devStatus?s.con.devStatus="异常":s.con.devStatus="正常",17==s.con.devLockState?(s.con.devLockState="开启",s.value2=!0):(s.con.devLockState="关闭",s.value2=!1),""==s.ying&&(s.ying="无"),""==s.con.devIccid&&(s.con.devIccid="无"),17==s.con.devDefence?(s.con.devDefence="未布防",s.value3=!0):(s.con.devDefence="已布防",s.value3=!1),17==s.con.devUnlockWay?s.con.devUnlockWay="IC卡":18==s.con.devUnlockWay?s.con.devUnlockWay="手机":20==s.con.devUnlockWay?s.con.devUnlockWay="应急开锁":s.con.devUnlockWay="未激活",17==s.con.devLockState&&(s.con.devLockState="倾斜报警"),33==s.con.devDefence&&(s.con.devDefence="温度压力传感器异常"),36==s.con.devDefence&&(s.con.devDefence="压力传感器初始化失败"),void 0==a.target?(o=(i=a).b,r=i.a):(o=(i=a.target).getPosition().lng,r=i.getPosition().lat);var c={width:620,height:310,title:"<div><div class='letg'><div><div class='grid-content'>设备类型：</div>消防栓<br/><div class='grid-content'>设备编号：</div>"+s.ying+"<br/><div class='grid-content'>锁的状态：</div>"+s.con.devLockState+"<br/><div class='grid-content'>设备电量：</div>"+s.con.devVOL+"<br/><div class='grid-content'>设备纬度：</div>"+s.con.devLatitude+"<br/><div class='grid-content'>设备水温：</div>"+s.con.waterTemperature+"<br/><div class='grid-content'>瞬间流量：</div>"+s.con.waterMeterTemp+"<br/><div class='grid-content'>硬件版本：</div>"+s.con.devHardVerison+"<br/></div><div style='width:40%'><div class='grid-content'>设备ID：</div>"+e.slice(5,e.length)+"<br/><div class='grid-content'>流量卡号：</div>"+s.con.devIccid+"<br/><div class='grid-content'>是否布防：</div>"+s.con.devDefence+"<br/><div class='grid-content'>设备状态：</div>"+s.con.devStatus+"<br/><div class='grid-content'>设备经度：</div>"+s.con.devLongitude+"<br/><div class='grid-content'>设备水压：</div>"+s.con.waterPressure+"<br/><div class='grid-content'>累计流量：</div>"+s.con.waterMeterTotal+"<br/><div class='grid-content'>软件版本：</div>"+s.con.devSoftVerison+"<br/></div><div style='width:25%;height:310px'><img src='../../../static/image/fira.jpg' style='width:100%;height:100%;'></div></div><div><button type='success' class='oyButton' onClick=\"task('"+e.slice(5,e.length)+"')\">可视化</button></div></div>"},u=new BMap.Point(o,r),v=new BMap.InfoWindow(e,c);t.map.openInfoWindow(v,u)})}}},p={render:function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{attrs:{id:"Edistribution"}},[t("div",{attrs:{id:"allmap"}}),e._v(" "),t("div",{staticClass:"shezhi"},[t("el-input",{staticClass:"oYinp",attrs:{clearable:"",placeholder:"请输入查询的设备编号"},model:{value:e.inputDev,callback:function(a){e.inputDev=a},expression:"inputDev"}}),e._v(" "),t("el-button",{staticClass:"oyButton ccc",attrs:{type:"success",icon:"el-icon-search"},on:{click:e.mappInput}},[e._v("查询")])],1),e._v(" "),t("el-dialog",{attrs:{title:"数据统计",visible:e.universal.statistic},on:{"update:visible":function(a){e.$set(e.universal,"statistic",a)}}},[[t("el-tabs",{attrs:{type:"card"},model:{value:e.activeName,callback:function(a){e.activeName=a},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:"水压统计",name:"fourth"}},[t("div",[t("div",{staticClass:"block"},[t("span",{staticClass:"demonstration"},[e._v("开始时间:")]),e._v(" "),t("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-ddTHH:mm:ss",placeholder:"选择日期时间"},model:{value:e.value1,callback:function(a){e.value1=a},expression:"value1"}}),e._v(" "),t("span",{staticClass:"demonstration"},[e._v("结束时间:")]),e._v(" "),t("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-ddTHH:mm:ss",placeholder:"选择日期时间"},model:{value:e.value2,callback:function(a){e.value2=a},expression:"value2"}})],1),e._v(" "),t("el-button",{staticClass:"oyButton butt",attrs:{type:"success",icon:"el-icon-search"},on:{click:e.elding}},[e._v("确定")]),e._v(" "),t("div",{staticStyle:{width:"700px",height:"600px"},attrs:{id:"main3"}})],1)]),e._v(" "),t("el-tab-pane",{attrs:{label:"水流量统计",name:"fifth"}},[t("div",{staticClass:"block"},[t("span",{staticClass:"demonstration"},[e._v("开始时间:")]),e._v(" "),t("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"选择日期时间"},model:{value:e.value3,callback:function(a){e.value3=a},expression:"value3"}}),e._v(" "),t("span",{staticClass:"demonstration"},[e._v("结束时间:")]),e._v(" "),t("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"选择日期时间"},model:{value:e.value4,callback:function(a){e.value4=a},expression:"value4"}})],1),e._v(" "),t("el-button",{staticClass:"oyButton butt",attrs:{type:"success",icon:"el-icon-search"},on:{click:e.elding1}},[e._v("确定")]),e._v(" "),t("div",{staticStyle:{width:"700px",height:"600px"},attrs:{id:"main4"}})],1),e._v(" "),t("el-tab-pane",{attrs:{label:"水温统计",name:"sixth"}},[t("div",{staticClass:"block"},[t("span",{staticClass:"demonstration"},[e._v("开始时间:")]),e._v(" "),t("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-ddTHH:mm:ss",placeholder:"选择日期时间"},model:{value:e.value8,callback:function(a){e.value8=a},expression:"value8"}}),e._v(" "),t("span",{staticClass:"demonstration"},[e._v("结束时间:")]),e._v(" "),t("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-ddTHH:mm:ss",placeholder:"选择日期时间"},model:{value:e.value9,callback:function(a){e.value9=a},expression:"value9"}})],1),e._v(" "),t("el-button",{staticClass:"oyButton butt",attrs:{type:"success",icon:"el-icon-search"},on:{click:e.elding2}},[e._v("确定")]),e._v(" "),t("div",{staticStyle:{width:"700px",height:"600px"},attrs:{id:"main5"}})],1),e._v(" "),t("el-tab-pane",{attrs:{label:"电压统计",name:"seventh"}},[t("div",{staticClass:"block"},[t("span",{staticClass:"demonstration"},[e._v("开始时间:")]),e._v(" "),t("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-ddTHH:mm:ss",placeholder:"选择日期时间"},model:{value:e.value15,callback:function(a){e.value15=a},expression:"value15"}}),e._v(" "),t("span",{staticClass:"demonstration"},[e._v("结束时间:")]),e._v(" "),t("el-date-picker",{attrs:{type:"datetime","value-format":"yyyy-MM-ddTHH:mm:ss",placeholder:"选择日期时间"},model:{value:e.value16,callback:function(a){e.value16=a},expression:"value16"}})],1),e._v(" "),t("el-button",{staticClass:"oyButton butt",attrs:{type:"success",icon:"el-icon-search"},on:{click:e.elding3}},[e._v("确定")]),e._v(" "),t("div",{staticStyle:{width:"700px",height:"640px"},attrs:{id:"main8"}})],1)],1)]],2),e._v(" "),t("el-dialog",{attrs:{title:"设备控制",visible:e.universal.onfile,width:"20%"},on:{"update:visible":function(a){e.$set(e.universal,"onfile",a)}}},[t("div",{staticClass:"flexdisply"},[t("div",{staticClass:"divswitch"},[t("span",[e._v("设备状态：")]),t("span",[e._v("设备"+e._s(e.value5))]),e._v(" "),t("div",{staticClass:"innerone",on:{click:function(a){e.changestatu(e.onfile)}}},[t("el-tooltip",{attrs:{content:e.value5,placement:"top"}},[t("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-value":"已激活","inactive-value":"未激活"},model:{value:e.value5,callback:function(a){e.value5=a},expression:"value5"}})],1)],1)]),e._v(" "),e.hidestatus?t("div",{staticClass:"divswitch"},[t("span",[e._v("栓锁状态：")]),t("span",[e._v("设备"+e._s(e.value6))]),e._v(" "),t("div",{staticClass:"innertwo",on:{click:function(a){e.changelock(e.onfile)}}},[t("el-tooltip",{attrs:{content:e.value6,placement:"top"}},[t("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-value":"已开阀","inactive-value":"未开阀"},model:{value:e.value6,callback:function(a){e.value6=a},expression:"value6"}})],1)],1)]):e._e(),e._v(" "),e.hidestatus?t("div",{staticClass:"divswitch"},[t("span",[e._v("布防状态：")]),t("span",[e._v("设备"+e._s(e.value7))]),e._v(" "),t("div",{staticClass:"innerthree",on:{click:function(a){e.changeting(e.onfile)}}},[t("el-tooltip",{attrs:{content:e.value7,placement:"top"}},[t("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-value":"已布防","inactive-value":"未布防"},model:{value:e.value7,callback:function(a){e.value7=a},expression:"value7"}})],1)],1)]):e._e()]),e._v(" "),t("div",[t("el-button",{staticClass:"lokway",attrs:{type:"danger"},on:{click:function(a){e.recover(e.onfile)}}},[e._v("恢复出厂设置")]),e._v(" "),t("el-button",{staticClass:"lokway",attrs:{type:"primary"},on:{click:function(a){e.read(e.onfile)}}},[e._v("读取定位信息")]),e._v(" "),t("el-button",{attrs:{type:"success"},on:{click:function(a){e.renewal(e.onfile)}}},[e._v("更新位置")])],1)])],1)},staticRenderFns:[]};var g=t("VU/8")(m,p,!1,function(e){t("tn8U"),t("Z1BK")},"data-v-153ec530",null);a.default=g.exports},Z1BK:function(e,a){},tn8U:function(e,a){}});