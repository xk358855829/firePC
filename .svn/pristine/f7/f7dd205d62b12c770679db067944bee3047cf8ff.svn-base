webpackJsonp([18],{"R/8c":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("mw3O"),o=a.n(i),r=a("OMN4"),n=a.n(r),s={name:"page",data:function(){return{data:[],defaultProps:{children:"children",label:"positionerId"},map:"",imgRise:"./static/image/rise.png",imgEnd:"./static/image/end.png",trajectory:{positionerId:"",positioneStart:"",positionereEnd:""}}},mounted:function(){this.dataList();var t=this;t.map=new BMap.Map("allmap");var e=new BMap.Point(120.21937542,30.25924446);t.map.centerAndZoom(e,12),(new BMap.Geolocation).getCurrentPosition(function(e){this.getStatus()==BMAP_STATUS_SUCCESS?(t.map.centerAndZoom(e.point,12),t.map.enableScrollWheelZoom()):alert("failed"+this.getStatus())},{enableHighAccuracy:!0}),document.title=this.$route.meta.title,document.getElementById("allmap").style.height=document.body.clientHeight-70+"px"},methods:{exhibition:function(){this.map.clearOverlays();var t=this;n()({method:"post",url:this.$store.state.http+"/group/groupByPos",data:o.a.stringify(this.trajectory)}).then(function(e){if(0==e.data.resCode){for(var a=[],i=0;i<e.data.result.length;i++)e.data.result[i],a.push(new BMap.Point(e.data.result[i].longtitude,e.data.result[i].latitude));var o=new BMap.Symbol(BMap_Symbol_SHAPE_BACKWARD_OPEN_ARROW,{fillColor:"#ff0000",fillOpacity:1,scale:.5,rotation:90,strokeColor:"#FFF",strokeOpacity:1,strokeWeight:0}),r=(new BMap.IconSequence(o,"0","1%",!0),new BMap.Polyline(a,{strokeColor:"#00ffcc",strokeWeight:10,strokeOpacity:1})),n=new BMap.Icon(t.imgRise,new BMap.Size(90,100),{imageSize:new BMap.Size(45,50),imageOffset:new BMap.Size(22,5)}),s=new BMap.Icon(t.imgEnd,new BMap.Size(90,100),{imageSize:new BMap.Size(45,50),imageOffset:new BMap.Size(22,5)}),l=new BMap.Marker(a[0],{icon:n}),d=new BMap.Marker(a[a.length-1],{icon:s});t.map.addOverlay(l),t.map.addOverlay(d),t.map.addOverlay(r),t.map.panTo(a[0])}})},handleNodeClick:function(t){t.children||(this.trajectory.positionerId=t.positionerId,this.map.clearOverlays())},dataList:function(){var t=this;n()({method:"post",url:this.$store.state.http+"/group/groupByCar",data:o.a.stringify({userId:sessionStorage.getItem("userId")})}).then(function(e){if(t.data=e.data.result,0==e.data.resCode)for(var a=0,i=e.data.result.length;a<i;a++)t.data[a].positionerId=e.data.result[a].agroup;else t.data=[]})}}},l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"CarTrajectory"}},[t._m(0),t._v(" "),a("div",{staticClass:"titleLeft"},[a("div",{staticClass:"heightTop"},[a("el-tree",{attrs:{data:t.data,accordion:!0,"node-key":"group",props:t.defaultProps},on:{"node-click":t.handleNodeClick}})],1),t._v(" "),a("div",[a("span",[t._v(" 车辆信息：")]),t._v(" "),a("el-input",{staticClass:"time",attrs:{placeholder:"请输入内容",disabled:!0},model:{value:t.trajectory.positionerId,callback:function(e){t.$set(t.trajectory,"positionerId",e)},expression:"trajectory.positionerId"}}),a("br"),a("br"),t._v(" "),a("span",[t._v(" 开始时间：")]),t._v(" "),a("el-date-picker",{staticClass:"time",attrs:{"value-format":"yyyy-MM-dd HH:mm:ss",type:"datetime",placeholder:"选择日期时间"},model:{value:t.trajectory.positioneStart,callback:function(e){t.$set(t.trajectory,"positioneStart",e)},expression:"trajectory.positioneStart"}}),a("br"),a("br"),t._v(" "),a("span",[t._v(" 结束时间：")]),t._v(" "),a("el-date-picker",{staticClass:"time",attrs:{"value-format":"yyyy-MM-dd HH:mm:ss",type:"datetime",placeholder:"选择日期时间"},model:{value:t.trajectory.positionereEnd,callback:function(e){t.$set(t.trajectory,"positionereEnd",e)},expression:"trajectory.positionereEnd"}}),a("br"),a("br"),t._v(" "),a("el-button",{staticClass:"oyButton",attrs:{type:"success"},on:{click:t.exhibition}},[t._v("展示轨迹")])],1)])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"titleRight"},[e("div",{attrs:{id:"allmap"}})])}]};var d=a("VU/8")(s,l,!1,function(t){a("uKQh")},"data-v-5c7b07e1",null);e.default=d.exports},uKQh:function(t,e){}});